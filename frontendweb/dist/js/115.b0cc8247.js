"use strict";(self["webpackChunkhopeui_vue"]=self["webpackChunkhopeui_vue"]||[]).push([[115],{8904:function(a,e,t){t.d(e,{A:function(){return k}});var l=t(6768),s=t(4232);const o={class:"modal fade",id:"message-alert",tabindex:"-1","aria-labelledby":"deleteConfirmationLabel","aria-hidden":"true"},n={class:"modal-dialog"},i={class:"modal-content"},d={class:"modal-header"},r={class:"modal-title",id:"deleteConfirmationLabel"},u={class:"modal-body"},c=["innerHTML"];function m(a,e,t,m,b,v){return(0,l.uX)(),(0,l.CE)("div",o,[(0,l.Lk)("div",n,[(0,l.Lk)("div",i,[(0,l.Lk)("div",d,[(0,l.Lk)("h5",r,(0,s.v_)(""==t.title?"Alert Dialog":t.title),1),e[0]||(e[0]=(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,l.Lk)("div",u,[(0,l.Lk)("p",{innerHTML:t.message},null,8,c)]),e[1]||(e[1]=(0,l.Lk)("div",{class:"modal-footer"},[(0,l.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Tutup")],-1))])])])}var b={name:"MessageModal",props:{title:{type:String,required:!1},message:{type:String,required:!0}}},v=t(1241);const p=(0,v.A)(b,[["render",m]]);var k=p},8115:function(a,e,t){t.r(e),t.d(e,{default:function(){return q}});t(4114),t(4603),t(7566),t(8721);var l=t(6768),s=t(5130),o=t(4232),n=t(144),i=t(4373),d=t(7363),r=t(8904),u=t(8077);const c={class:"row"},m={class:"col-sm-12"},b={class:"card"},v={class:"card-body"},p={class:"row mb-2"},k={class:"col-sm-6"},h={class:"input-group has-validation"},g={class:"row mb-2"},L={class:"col-sm-6 pagination-show-entries"},y={class:"table-responsive border-bottom"},f={class:"pagination-container"},w={class:"text-muted"},_={"aria-label":"Page navigation example"},C={class:"pagination justify-content-end"},U=["onClick"],x={class:"modal-dialog"},A={class:"modal-content"},E={class:"modal-header"},B={class:"modal-title",id:"staticBackdropPermissionLabel"},S={class:"modal-body"},F={class:"mb-3"},R=["data-bs-dismiss"],K={class:"modal fade",id:"delete-confirmation",tabindex:"-1","aria-labelledby":"deleteConfirmationLabel","aria-hidden":"true"},I={class:"modal-dialog"},D={class:"modal-content"},$={class:"modal-body"},P={class:"modal fade",id:"mass-upload-modal",tabindex:"-1","aria-labelledby":"massUploadModalLabel","aria-hidden":"true"},z={class:"modal-dialog"},G={class:"modal-content"},M={class:"modal-body"},T={class:"mb-3"},j={type:"file",id:"upload-file",ref:"fileInput",accept:".xlsx, .csv",required:"",class:"form-control"};var H={__name:"ListUnit",setup(a){const e=(0,n.KR)(""),t=(0,n.KR)(""),H=localStorage.getItem("access_token"),N=(0,n.KR)([]),W=(0,n.KR)(""),q=(0,n.KR)(""),V=(0,n.KR)(1),X=(0,n.KR)(0),J=(0,n.KR)(10),O=(0,n.KR)(0),Q=[{title:"Nama Unit",data:"unit_name",sortable:!0},{title:"Aksi",data:"actions",sortable:!1}];(0,l.sV)((async()=>{await aa()}));const Y=(0,n.KR)({column:"unit_id",order:"DESC"}),Z=({column:a,order:e})=>{Y.value={column:a,order:e},aa()},aa=async()=>{try{const a=await i.A.get("http://localhost:3000/api/asset_unit",{headers:{Authorization:`Bearer ${H}`},params:{unit_name:W.value,search:q.value,order_by:Y.value.column,order_direction:Y.value.order,page:V.value,pageSize:J.value}});N.value=a.data.rows,O.value=a.data.sp.rowCount,X.value=Math.ceil(a.data.sp.rowCount/J.value)}catch(a){console.error("Error fetching unit data:",a),va()}},ea=a=>{a>=1&&a<=X.value&&(V.value=a,aa())},ta=(0,n.KR)(!1),la=(0,n.KR)({unit_id:null,unit_name:""}),sa=()=>{la.value={unit_id:null,unit_name:""}},oa=async()=>{try{const a=await i.A.get("http://localhost:3000/api/asset_unit/export",{headers:{Authorization:`Bearer ${H}`},params:{unit_name:W.value,search:q.value,order_by:Y.value.column,order_direction:Y.value.order},responseType:"blob"}),e=window.URL.createObjectURL(new Blob([a.data])),t=document.createElement("a");t.href=e,t.setAttribute("download","data_unit.xlsx"),document.body.appendChild(t),t.click(),t.parentNode.removeChild(t)}catch(a){console.error("Error exporting data:",a),e.value="Gagal Ekspor",t.value="Gagal mengekspor data. Silakan coba lagi.";const l=new u.aF(document.getElementById("message-alert"));l.show()}},na=async()=>{const a=document.getElementById("upload-file"),l=a.files[0];if(!l){e.value="Pilih File",t.value="Silakan pilih file sebelum mengunggah.";const a=new u.aF(document.getElementById("message-alert"));return void a.show()}const s=new FormData;s.append("file",l);try{const a=await i.A.post("http://localhost:3000/api/asset_unit/mass-upload",s,{headers:{Authorization:`Bearer ${H}`,"Content-Type":"multipart/form-data"}});e.value="Berhasil",t.value=`Upload berhasil, ${a.data.successCount} data unit berhasil terupload`;const l=new u.aF(document.getElementById("message-alert"));l.show(),aa()}catch(o){console.error("Gagal mengunggah file:",o),e.value="Gagal Upload",t.value="Gagal mengunggah file. Pastikan format file benar.";const a=new u.aF(document.getElementById("message-alert"));a.show()}},ia=async()=>{try{const a=await i.A.get("http://localhost:3000/api/asset_unit/template/",{headers:{Authorization:`Bearer ${H}`},responseType:"blob"}),e=window.URL.createObjectURL(new Blob([a.data])),t=document.createElement("a");t.href=e,t.setAttribute("download","template_data_unit.xlsx"),document.body.appendChild(t),t.click(),t.parentNode.removeChild(t)}catch(a){console.error("Error downloading template:",a),e.value="Gagal Download",t.value="Gagal mendownload template. Silakan coba lagi.";const l=new u.aF(document.getElementById("message-alert"));l.show()}},da=()=>{sa(),ta.value=!1},ra=a=>{ca.value=a,la.value={...a},ta.value=!0},ua=async()=>{console.log("Edit data submitted:",la.value);try{if(ta.value){const a=await i.A.put(`http://localhost:3000/api/asset_unit/${la.value.unit_id}`,la.value,{headers:{Authorization:`Bearer ${H}`}});console.log("Data berhasil diupdate:",a.data);const e=N.value.findIndex((a=>a.unit_id===la.value.unit_id));-1!==e&&(N.value[e]={...la.value})}else{const a=await i.A.post("http://localhost:3000/api/asset_unit",la.value,{headers:{Authorization:`Bearer ${H}`}});console.log("Data berhasil ditambahkan:",a.data),N.value.push(a.data),aa()}}catch(a){console.error("Gagal mengupdate data:",a),va()}},ca=(0,n.KR)(null),ma=a=>{ca.value=a},ba=async()=>{try{console.log("Id deleted:",ca.value.unit_id),await i.A.delete(`http://localhost:3000/api/asset_unit/${ca.value.unit_id}`,{headers:{Authorization:`Bearer ${H}`}}),e.value="Berhasil Hapus",t.value=`Data Unit <strong>${ca.value.unit_name}</strong> berhasil dihapus.`;const a=new u.aF(document.getElementById("message-alert"));a.show(),aa()}catch(a){console.error("Failed to delete unit data:",a),va()}},va=()=>{e.value="Koneksi Gagal",t.value="Cek koneksi internet Anda.";const a=new u.aF(document.getElementById("message-alert"));a.show()};return(a,n)=>((0,l.uX)(),(0,l.CE)("div",c,[(0,l.Lk)("div",m,[(0,l.Lk)("div",b,[(0,l.Lk)("div",{class:"card-header d-flex justify-content-between"},[n[6]||(n[6]=(0,l.Lk)("div",{class:"header-title"},[(0,l.Lk)("h4",{class:"card-title"},"List Satuan")],-1)),(0,l.Lk)("div",null,[(0,l.Lk)("button",{class:"btn btn-success",style:{"margin-right":"10px"},onClick:da,"data-bs-toggle":"modal","data-bs-target":"#form-confirmation"}," Tambah Unit "),(0,l.Lk)("button",{class:"btn btn-outline-success",style:{"margin-right":"10px"},onClick:oa}," Ekspor Data "),n[5]||(n[5]=(0,l.Lk)("button",{class:"btn btn-info",style:{"margin-right":"10px"},"data-bs-toggle":"modal","data-bs-target":"#mass-upload-modal"}," Mass Upload ",-1)),(0,l.Lk)("button",{class:"btn btn-outline-info",onClick:ia}," Download Template ")])]),(0,l.Lk)("div",v,[(0,l.Lk)("div",p,[(0,l.Lk)("div",k,[n[7]||(n[7]=(0,l.Lk)("label",{for:"validationCustomUsername01",class:"form-label"},"Filter nama unit",-1)),(0,l.Lk)("div",h,[(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":n[0]||(n[0]=a=>W.value=a),class:"form-control filter-style",id:"validationCustomUsername01","aria-describedby":"inputGroupPrepend"},null,512),[[s.Jo,W.value]])])]),(0,l.Lk)("div",{class:"col-sm-4"},[n[8]||(n[8]=(0,l.Lk)("label",{for:"validationCustomUsername01",class:"form-label text-white"},"I",-1)),(0,l.Lk)("div",{class:"input-group has-validation"},[(0,l.Lk)("button",{class:"btn btn-primary width-button-style filter-style",onClick:aa,title:"Search"}," Filter ")])])]),(0,l.Lk)("div",g,[(0,l.Lk)("div",L,[n[10]||(n[10]=(0,l.Lk)("label",{for:"entries",class:"form-label col-sm-3"},"Show entries",-1)),(0,l.bo)((0,l.Lk)("select",{id:"entries",class:"form-select show-entries","onUpdate:modelValue":n[1]||(n[1]=a=>J.value=a),onChange:aa},n[9]||(n[9]=[(0,l.Lk)("option",{value:"10"},"10",-1),(0,l.Lk)("option",{value:"25"},"25",-1),(0,l.Lk)("option",{value:"50"},"50",-1),(0,l.Lk)("option",{value:"100"},"100",-1)]),544),[[s.u1,J.value]])])]),(0,l.Lk)("div",y,[(0,l.bF)(d.A,{data:N.value,columns:Q,currentPage:V.value,pageSize:J.value,idrow:a.unit_id,onEdit:ra,onDelete:ma,onSort:Z},null,8,["data","currentPage","pageSize","idrow"]),(0,l.Lk)("div",f,[(0,l.Lk)("p",w," Showing "+(0,o.v_)((V.value-1)*J.value+1)+" to "+(0,o.v_)(Math.min(V.value*J.value,O.value))+" of "+(0,o.v_)(O.value)+" entries ",1),(0,l.Lk)("nav",_,[(0,l.Lk)("ul",C,[(0,l.Lk)("li",{class:(0,o.C4)(["page-item",{disabled:1===V.value}])},[(0,l.Lk)("button",{class:"page-link",onClick:n[2]||(n[2]=a=>ea(V.value-1))},"Previous")],2),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(X.value,(a=>((0,l.uX)(),(0,l.CE)("li",{class:(0,o.C4)(["page-item",{active:V.value===a}]),key:a},[(0,l.Lk)("button",{class:"page-link",onClick:e=>ea(a)},(0,o.v_)(a),9,U)],2)))),128)),(0,l.Lk)("li",{class:(0,o.C4)(["page-item",{disabled:V.value===X.value}])},[(0,l.Lk)("button",{class:"page-link",onClick:n[3]||(n[3]=a=>ea(V.value+1))},"Next")],2)])])]),(0,l.Lk)("div",{class:"modal fade",id:"form-confirmation","data-bs-backdrop":"static","data-bs-keyboard":"true",tabindex:"-1","aria-labelledby":"staticBackdropPermissionLabel","aria-hidden":"true",onHide:sa},[(0,l.Lk)("div",x,[(0,l.Lk)("div",A,[(0,l.Lk)("div",E,[(0,l.Lk)("h5",B,(0,o.v_)(ta.value?"Perbarui Unit":"Tambah Unit"),1),n[11]||(n[11]=(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,l.Lk)("div",S,[n[13]||(n[13]=(0,l.Lk)("p",null,[(0,l.eW)("Form yang bertanda "),(0,l.Lk)("span",{class:"text-primary"},"*"),(0,l.eW)(" wajib diisi")],-1)),(0,l.Lk)("form",{onSubmit:(0,s.D$)(ua,["prevent"])},[(0,l.Lk)("div",F,[n[12]||(n[12]=(0,l.Lk)("label",{for:"unit_name",class:"form-label"},[(0,l.eW)("Nama Unit"),(0,l.Lk)("span",{class:"text-primary"},"*")],-1)),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":n[4]||(n[4]=a=>la.value.unit_name=a),maxlength:"100",id:"unit_name",type:"text",required:"",class:"form-control"},null,512),[[s.Jo,la.value.unit_name]])]),(0,l.Lk)("button",{type:"submit",class:"btn btn-primary","data-bs-dismiss":la.value.unit_name?"modal":null},(0,o.v_)(ta.value?"Simpan Perubahan":"Tambahkan Unit"),9,R)],32)])])])],32),(0,l.Lk)("div",K,[(0,l.Lk)("div",I,[(0,l.Lk)("div",D,[n[17]||(n[17]=(0,l.Lk)("div",{class:"modal-header"},[(0,l.Lk)("h5",{class:"modal-title",id:"deleteConfirmationLabel"},"Konfirmasi Hapus"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,l.Lk)("div",$,[(0,l.Lk)("p",null,[n[14]||(n[14]=(0,l.eW)("Apa kamu yakin ingin menghapus data Unit ")),(0,l.Lk)("strong",null,(0,o.v_)(ca.value?.unit_name),1),n[15]||(n[15]=(0,l.eW)("?"))])]),(0,l.Lk)("div",{class:"modal-footer"},[n[16]||(n[16]=(0,l.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Cancel",-1)),(0,l.Lk)("button",{type:"button",class:"btn btn-primary","data-bs-dismiss":"modal",onClick:ba},"Delete")])])])]),(0,l.Lk)("div",P,[(0,l.Lk)("div",z,[(0,l.Lk)("div",G,[n[20]||(n[20]=(0,l.Lk)("div",{class:"modal-header"},[(0,l.Lk)("h5",{class:"modal-title",id:"massUploadModalLabel"},"Mass Upload Unit"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,l.Lk)("div",M,[(0,l.Lk)("form",{onSubmit:(0,s.D$)(na,["prevent"])},[(0,l.Lk)("div",T,[n[18]||(n[18]=(0,l.Lk)("label",{for:"upload-file",class:"form-label"},"Pilih File",-1)),(0,l.Lk)("input",j,null,512)]),n[19]||(n[19]=(0,l.Lk)("button",{type:"submit",class:"btn btn-primary"},"Upload",-1))],32)])])])]),(0,l.bF)(r.A,{message:t.value,title:e.value},null,8,["message","title"])])])])])]))}},N=t(1241);const W=(0,N.A)(H,[["__scopeId","data-v-7dff16fe"]]);var q=W}}]);